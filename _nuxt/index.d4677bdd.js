import{r as M,a as y}from"./index.7a919e48.js";import{u as I}from"./globals.27b1f73a.js";import{f as g,_ as f,o as l,c,F as m,r as R,n as b,g as T,v as k,a as o,t as r,d as u,h as D,i as P,j as $,b as v,k as V,w as z,T as E,p as N,e as A,l as B,m as L}from"./entry.492c9416.js";const O=[91],w=()=>{const{lang:e}=I();let t=M.map(s=>({...s,name:s.name[e]}));return e==="ru"?t:t.filter(({rusCode:s})=>!O.includes(s))};function Y(e){return e===null}function W(e){return e===void 0}const X=e=>!Y(e)&&!W(e),C=1470,U="main-content",j=g({name:"RussiaMap",props:{activeRegion:{type:Object,default:null}},emits:["update:activeRegion"],setup(){return{regions:w()}},data(){return{width:null,height:null,tooltipX:null,tooltipY:null,hoveredRegion:null}},computed:{sizeProvider(){const{tooltipX:e,tooltipY:t,height:s,width:i}=this;return{"--width":this.toPixels(i),"--height":this.toPixels(s),"--tooltip-x":this.toPixels(e+20),"--tooltip-y":this.toPixels(t)}},isTooltipShown(){const{hoveredRegion:e,tooltipX:t,tooltipY:s}=this;return[e,t,s].every(i=>X(i))}},methods:{getMainContent(){return document.getElementById(U)},toPixels(e){return e?`${y(e)}px`:null},calculateMapSize(){if(!this.$el)return;const t=this.getMainContent();t&&(window.innerWidth<=C?(this.width=null,this.height=null):(this.width=t.offsetWidth*.65,this.height=t.offsetHeight*.85,+(this.width/this.height).toFixed(2)>1.8&&(this.height=this.width/1.8)))},resetTooltipPosition(){this.tooltipX=null,this.tooltipY=null},onRegionEnter(e){this.hoveredRegion=e,this.$emit("update:activeRegion",e)},onRegionLeave({relatedTarget:e}){e instanceof Element&&e.hasAttribute("data-region-id")||(this.hoveredRegion=null,this.$emit("update:activeRegion",null))},onMouseMove({clientX:e,clientY:t,target:s}){const i=this.getMainContent(),d=this.$refs.tooltip;!i||!d||(this.tooltipX=e,t+d.offsetHeight>=i.offsetHeight?this.tooltipY=t-d.offsetHeight:this.tooltipY=t)}},async mounted(){this.calculateMapSize(),window.addEventListener("resize",this.calculateMapSize)},unmounted(){window.removeEventListener("resize",this.calculateMapSize)},watch:{activeRegion(e){e||this.resetTooltipPosition()}}});const F=["data-region-id","fill","d","onMouseenter"],H={ref:"tooltip",class:"map__tooltip"},q={key:0,class:"map__tooltip__content"},G={class:"map__tooltip__row-name"},K=["src"],J={class:"map__tooltip__name"},Q={class:"map__tooltip__row-indicator"},Z={class:"map__tooltip__salary"},x={class:"map__tooltip__row-indicator"},ee={class:"map__tooltip__employed"},te={class:"map__tooltip__row-indicator"},oe={class:"map__tooltip__losses"};function se(e,t,s,i,d,p){return l(),c("div",{ref:"mapWrapper",class:"map-wrapper",style:P(e.sizeProvider)},[(l(),c("svg",{viewBox:"-65 0 1134 620",version:"1.1",xmlns:"http://www.w3.org/2000/svg",class:"map",preserveAspectRatio:"none",onMousemove:t[1]||(t[1]=(...a)=>e.onMouseMove&&e.onMouseMove(...a))},[(l(!0),c(m,null,R(e.regions,a=>(l(),c(m,{key:a.id},[(l(!0),c(m,null,R(a.paths,(n,_)=>(l(),c("path",{key:_,"data-region-id":a.id,fill:a.color,d:n,class:b(["map__path",{map__path_active:e.activeRegion&&e.activeRegion.id===a.id}]),onMouseenter:h=>e.onRegionEnter(a),onMouseleave:t[0]||(t[0]=(...h)=>e.onRegionLeave&&e.onRegionLeave(...h))},null,42,F))),128))],64))),128))],32)),T(o("div",H,[e.hoveredRegion?(l(),c("div",q,[o("div",G,[o("img",{src:e.$baseUrl.append(`/regions/${e.hoveredRegion.img}`),class:"map__tooltip__flag"},null,8,K),o("span",J,r(e.hoveredRegion.name),1)]),o("div",Q,[u(r(e.$int.dict.panel.map.salary)+": ",1),o("span",null,[o("span",Z,r(e.hoveredRegion.salary),1),u(" "+r(e.$int.dict.measurement.thousand)+" ₽ ",1)])]),o("div",x,[u(r(e.$int.dict.panel.map.employed)+": ",1),o("span",null,[o("span",ee,r(e.hoveredRegion.employed),1),u(" "+r(e.$int.dict.measurement.thousand),1)])]),o("div",te,[u(r(e.$int.dict.panel.map.costs)+": ",1),o("span",null,[o("span",oe,r(e.hoveredRegion.costs),1),u(" "+r(e.$int.dict.measurement.billion)+" ₽ ",1)])])])):D("",!0)],512),[[k,e.isTooltipShown]])],4)}const ne=f(j,[["render",se],["__scopeId","data-v-4eaaf6b3"]]),ie=g({name:"RegionsTableSort",props:{activeDir:{type:String,default:null},activeSort:{type:String,default:null},sort:{type:String,required:!0}},emits:["change"],computed:{isAscDir(){return this.activeDir==="asc"},icon(){return this.activeSort!==this.sort?"fa-sort":`fa-sort-amount-${this.isAscDir?"down":"up"}`}},methods:{onClick(){const e=this.isAscDir?"desc":"asc";this.$emit("change",this.sort,e)}}});function ae(e,t,s,i,d,p){return l(),c("i",{class:b(["fas",e.icon]),title:"Сортировать",onClick:t[0]||(t[0]=(...a)=>e.onClick&&e.onClick(...a))},null,2)}const re=f(ie,[["render",ae]]),le={ru:"ru-RU",en:"en-GB"},ce=g({name:"RegionsTable",components:{SortIcon:re},props:{activeRegion:{type:Object,default:null}},emits:["update:activeRegion"],setup(){return{regions:w()}},data(){return{sortDir:"asc",sortId:"name"}},computed:{columns(){return[{id:"name",label:{en:"Region",ru:"Субъект РФ"},sortType:"character"},{id:"salary",label:{en:"Average salary, th. ₽",ru:"Средняя зарплата, тыс. ₽"},sortType:"numeric"},{id:"employed",label:{en:"Number of employed, th.",ru:"Численность занятых, тыс."},sortType:"numeric"},{id:"costs",label:{en:"Total costs, bn. ₽",ru:"Суммарные потери, млрд. ₽"},sortType:"numeric"}].map(e=>({...e,label:e.label[this.$int.lang]}))},localeCompareParam(){return le[this.$int.lang]},rows(){const{sortType:e}=this.columns.find(({id:i})=>this.sortId===i),{sortDir:t}=this;return[...this.regions].sort((i,d)=>{const p=t==="asc";if(e==="character"){const a=this.sortId,n=i[a],_=d[a];return p?n.localeCompare(_,this.localeCompareParam):_.localeCompare(n,this.localeCompareParam)}else{const a=this.sortId,n=i[a],_=d[a];return p?n-_:_-n}})}},methods:{onSelect(e){var t;this.$emit("update:activeRegion",e.id===((t=this.activeRegion)==null?void 0:t.id)?null:e)},onSort(e,t){this.sortId=e,this.sortDir=t}},watch:{activeRegion(e){const t=this.$refs.tableBody;if(!t||!e)return;const{id:s}=e,i=t.querySelector(`[data-region-id="${s}"]`);!i||window.innerWidth<=C||i.scrollIntoView({block:"center"})}}});const de={class:"regions-table"},_e={class:"regions-table__head"},pe={ref:"tableBody",class:"regions-table__body"},ue=["data-region-id","onClick"],he={class:"regions-table__row__cell"},ge={class:"regions-table__row__cell"},me={class:"regions-table__row__cell"},ve={class:"regions-table__row__cell"};function fe(e,t,s,i,d,p){const a=$("SortIcon");return l(),c("div",de,[o("div",_e,[(l(!0),c(m,null,R(e.columns,({id:n,label:_})=>(l(),c("div",{key:n,class:"regions-table__row__cell"},[u(r(_)+" ",1),v(a,{"active-sort":e.sortId,"active-dir":e.sortDir,sort:n,class:"regions-table__head__sort",onChange:e.onSort},null,8,["active-sort","active-dir","sort","onChange"])]))),128))]),o("div",pe,[(l(!0),c(m,null,R(e.rows,n=>(l(),c("div",{key:n.id,"data-region-id":n.id,class:b(["regions-table__row",{"regions-table__row_selected":e.activeRegion&&e.activeRegion.id===n.id}]),onClick:_=>e.onSelect(n)},[o("div",he,r(n.name),1),o("div",ge,r(n.salary),1),o("div",me,r(n.employed),1),o("div",ve,r(n.costs),1)],10,ue))),128))],512)])}const $e=f(ce,[["render",fe],["__scopeId","data-v-a22371e7"]]),Re=g({name:"RegionCard",props:{activeRegion:{type:Object,default:null}},setup(e){const t=w(),s=y(t.reduce((d,{costs:p})=>d+p,0));return{shareValue:V(()=>(e.activeRegion?y(e.activeRegion.costs/s*100):0).toFixed(2))}}});const S=e=>(N("data-v-72930a22"),e=e(),A(),e),ye={class:"region-card"},be={class:"region-card__header"},we=S(()=>o("div",{class:"region-card__header__icon-holder"},[o("i",{class:"fas fa-chart-bar region-card__header__icon-holder__icon"})],-1)),Se={class:"region-card__header__share"},Ce={class:"region-card__header__share__title"},Me={class:"region-card__header__share__details"},Ie=S(()=>o("span",{class:"region-card__header__share__details__percent"}," % ",-1)),Te={class:"region-card__footer"},ke=S(()=>o("i",{class:"fas fa-exclamation region-card__footer__icon"},null,-1));function De(e,t,s,i,d,p){return l(),c("div",ye,[o("div",be,[we,o("div",Se,[o("span",Ce,r(e.$int.dict.panel.card.heading),1),o("span",Me,[v(E,{name:"roll",mode:"out-in"},{default:z(()=>[(l(),c("span",{key:e.shareValue,class:"region-card__header__share__details__value"},r(e.shareValue),1))]),_:1}),Ie])])]),o("div",Te,[ke,u(" "+r(e.$int.dict.panel.card.hint),1)])])}const Pe=f(Re,[["render",De],["__scopeId","data-v-72930a22"]]),Ve=g({name:"RegionSection",components:{RussianMap:ne,RegionsTable:$e,RegionCard:Pe},setup(){return{activeRegion:B(null)}}});const ze={class:"region-section"};function Ee(e,t,s,i,d,p){const a=$("RussianMap"),n=$("RegionsTable"),_=$("RegionCard");return l(),c("div",ze,[v(a,{activeRegion:e.activeRegion,"onUpdate:activeRegion":t[0]||(t[0]=h=>e.activeRegion=h),class:"region-section__map"},null,8,["activeRegion"]),v(n,{activeRegion:e.activeRegion,"onUpdate:activeRegion":t[1]||(t[1]=h=>e.activeRegion=h),class:"region-section__table"},null,8,["activeRegion"]),v(_,{activeRegion:e.activeRegion,class:"region-section__card"},null,8,["activeRegion"])])}const Ne=f(Ve,[["render",Ee],["__scopeId","data-v-5b8a6a60"]]),Oe=g({__name:"index",setup(e){return(t,s)=>(l(),L(Ne))}});export{Oe as default};
